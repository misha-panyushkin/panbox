/* panbox - v0.0.1 - 2015-02-24
 * Homepage: http://panbox.panyushk.in/
 * Author: Misha Panyushkin <misha.panyushkin@gmail.com>
 * Copyright.*/

!function(a,b){function c(){var a,b,c,d;return a=document.createElement("div"),a.style.visibility="hidden",a.style.width="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a),b=a.offsetWidth,a.style.overflow="scroll",c=document.createElement("div"),c.style.width="100%",a.appendChild(c),d=c.offsetWidth,a.parentNode.removeChild(a),b-d}function d(){var a,b,c,d=$("[data-panbox-css]");d.length||(a="/* panbox core css */\n[data-panbox-contentbox]{width: 100%; height: 100%; overflow-y: scroll;}\n[data-panbox-coverbox]{overflow: hidden; display: inline-block; position: relative;}\n[data-panbox-scrollbar-track]{position: absolute; top: 0; right: 1px; bottom: 0; width: 7px;}\n[data-panbox-scrollbar-thumb]{position: absolute; top: 0; right: 0; width: 100%;}",c="/* panbox core css */\n[data-panbox-scrollbar-thumb]{background-color:#8A8A8A; border-radius:150px;}",b="/* panbox no width scrollbar css */\n[data-panbox-contentbox-nowidthscrollbar]::-webkit-scrollbar {-webkit-appearance: none;}\n[data-panbox-contentbox-nowidthscrollbar]::-webkit-scrollbar:vertical {display: none;}\n[data-panbox-contentbox-nowidthscrollbar]::-webkit-scrollbar-thumb {display: none;}\n[data-panbox-contentbox-nowidthscrollbar]::-webkit-scrollbar-track {display: none;}",$("<style>").attr("data-panbox-css",1).html(a+"\n\n"+c+"\n\n"+b).prependTo("head"))}function e(a,b){d(),this.$contentbox=$(a),this.$contentbox.get(0).panbox=this,this.wrap(b)}Function.prototype.bind=Function.prototype.bind||function(a){var b=Array.prototype.slice.call(arguments,1),c=this;return function(){var d=Array.prototype.slice.call(arguments);return c.apply(a,b.concat(d))}},e.prototype.defaults={thumb_height:20,update:function(){var a=this.$contentbox.get(0);this.scroll_top=a.scrollTop,this.scroll_height=a.scrollHeight,this.client_height=a.clientHeight,this.scroll_height!=this.client_height?(this.thumb_height=Math.pow(this.client_height,2)/this.scroll_height,this.thumb_height<this.defaults.thumb_height&&(this.thumb_height=this.defaults.thumb_height)):this.thumb_height=0,this.thumb_offset=this.client_height*this.scroll_top/this.scroll_height,this.$scrollthumb.css({height:this.thumb_height,top:this.thumb_offset}),!this.locked},mousedown:function(a){this._mousemove&&$(b).off("mousemove.panbox",this._mousemove),this._mousemove=this.defaults.mousemove.bind(this,this.scroll_top,a.pageY),$(b).on("mousemove.panbox",this._mousemove),this._mouseup&&$(b).off("mouseup.panbox",this._mouseup),this._mouseup=this.defaults.mouseup.bind(this),$(b).on("mouseup.panbox",this._mouseup)},mousemove:function(a,b,c){var d=this.$contentbox.get(0),e=c.pageY-b,f=e*this.scroll_height/this.client_height+a;0>f?f=0:f>this.scroll_height-this.client_height&&(f=this.scroll_height-this.client_height),d.scrollTop=f,c.preventDefault()},mouseup:function(){$(b).off("mousemove.panbox",this._mousemove),$(b).off("mouseup.panbox",this._mouseup)}},e.prototype.wrap=function(a){var b;return this.params=a||this.params||{},this.params.scrollthumb=this.params.scrollthumb||{},this.$contentbox.attr("data-panbox-contentbox",1),(b=0===c())?this.$contentbox.attr("data-panbox-contentbox-nowidthscrollbar",1):this.$contentbox.css("margin-right",-b),this.$coverbox=this.$coverbox||this.$contentbox.wrap("<div/>").parent().attr("data-panbox-coverbox",1),this.$coverbox.css({width:this.params.width||"100%",height:this.params.height||"100%"}),this.$scrollbar=this.$scrollbar||$("<div/>").attr("data-panbox-scrollbar-track",1).appendTo(this.$coverbox),this.$scrollthumb=this.$scrollthumb||$("<div/>").attr("data-panbox-scrollbar-thumb",1).appendTo(this.$scrollbar),this.params.scrollthumb.class_name&&this.$scrollthumb.addClass(this.params.scrollthumb.class_name),this._update=this.defaults.update.bind(this),this._update(),this._mousedown=this.defaults.mousedown.bind(this),this},e.prototype.unwrap=function(){return this.off(),this.$coverbox.replaceWith(this.$contentbox),this.$coverbox=null,this.$scrollbar=null,this.$scrollthumb=null,this},e.prototype.on=function(){return this.$contentbox.off("scroll.panbox",this._update).on("scroll.panbox",this._update),this.$scrollthumb.off("mousedown.panbox",this._mousedown).on("mousedown.panbox",this._mousedown),this},e.prototype.off=function(){return this.$contentbox.off("scroll.panbox",this._update),this.$scrollthumb.off("mousedown.panbox",this._mousedown),this._mousemove&&$(b).off("mousemove.panbox",this._mousemove),this._mouseup&&$(b).off("mouseup.panbox",this._mouseup),this},e.prototype.lock=function(){return this.locked=1,this},e.prototype.unlock=function(){return delete this.locked,this},e.prototype.scroll=function(a){var b=this.$contentbox.get(0);switch(a){case"top":b.scrollTop=0;break;case"bottom":b.scrollTop=b.scrollHeight;break;default:b.scrollTop=parseInt(a)||b.scrollTop}return this},a.panbox=function(a,b){var c=$(a).get(0);return c&&c.panbox?c.panbox:new e(a,b)}}(this,this);